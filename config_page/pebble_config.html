<!DOCTYPE html>
<html>
  <head>
    <title>Pebble Config Page</title>
    <link rel="stylesheet" href="pebble_config.css">
  </head>

  <body>
    <h1>Pebble App Config</h1>
    <p>Do you even <a href="https://www.youtube.com/watch?v=1wIV6l2ux_8">Clubcard</a> bro?</p>
    Card Name: <input type="text" id="cardName" Placeholder="Tesco"><br><br>
    Number: <input type="number" id="cardNumber" Placeholder="123456" pattern="\d*"><br><br>
    <button id="addcard_button">Add card</button>
  </body>

  <script>
    function checkInput() {
      if (document.getElementById("cardNumber").value.length % 2 !==  0) { return 1; }
      else if (document.getElementById("cardNumber").value.length ===  0) { return 1; }
      else if (document.getElementById("cardNumber").value.length >=  20) { return 1; }
      else if (document.getElementById("cardName").value.length >=  10) { return 1; }
      else { return 0; }
    };

    function saveOptions() {
      var cardName = document.getElementById("cardName");
      var cardNumber = document.getElementById("cardNumber");
      var options = {"name": cardName.value.concat("\0"), "number": cardNumber.value.concat("\0")};
      return options;
    };
   
    var submitButton = document.getElementById("addcard_button");
    submitButton.addEventListener("click", 
      function() {
        if (checkInput() === 1) {
          alert("Incorrect card number")
          return;
        } else {
        var options = saveOptions();
        var location = 'pebblejs://close#'+ encodeURIComponent(JSON.stringify(options));
        document.location = location;
        }
      }, 
    false);
  </script>
</html>